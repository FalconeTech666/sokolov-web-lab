<!DOCTYPE html>
<html lang="{{ current_lang }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Sokolov Web Lab{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='img/favicon.png') }}">

    <script>
        (function() {
            const savedTheme = localStorage.getItem('theme');
            const htmlElement = document.documentElement;

            if (savedTheme) {
                htmlElement.setAttribute('data-theme', savedTheme);
            } else {
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                if (prefersDark) {
                    htmlElement.setAttribute('data-theme', 'dark');
                }
            }
        })();
    </script>
</head>
<body>

    <header class="site-header">
        <div class="container header-inner">
            <!-- 1. Ð›Ð¾Ð³Ð¾Ñ‚Ð¸Ð¿ -->
            <a href="{{ url_for('index') }}" class="brand">
                <img src="{{ url_for('static', filename='img/logo.png') }}" alt="Logo" class="brand-logo">
                <span class="brand-title">Sokolov Web Lab</span>
            </a>

            <!-- 2. ÐÐ°Ð²Ð¸Ð³Ð°Ñ†Ð¸Ñ -->
            <nav class="main-nav">
                <a href="{{ url_for('index') }}">{{ t.menu_home }}</a>
                
                <!-- Ð’Ñ‹Ð¿Ð°Ð´Ð°ÑŽÑ‰Ð¸Ð¹ ÑÐ¿Ð¸ÑÐ¾Ðº "ÐœÐ¸Ð½Ð¸-Ð°Ð¿Ð¿Ñ‹" -->
                <div class="nav-dropdown">
                    <span class="dropdown-toggle" style="cursor: pointer;">{{ t.menu_apps }} â–¾</span>
                    <div class="dropdown-menu">
                        <a href="{{ url_for('duck') }}">ðŸ¦† {{ t.menu_ducks }}</a>
                        <a href="{{ url_for('fox') }}">ðŸ¦Š {{ t.menu_foxes }}</a>
                        <a href="{{ url_for('weather') }}">â›… {{ t.menu_weather }}</a>
                        <a href="{{ url_for('rates') }}">ðŸ’± {{ t.menu_rates }}</a>
                    </div>
                </div>

                <a href="{{ url_for('homework') }}">{{ t.menu_homework }}</a>
                
                <!-- Ð’Ñ‹Ð¿Ð°Ð´Ð°ÑŽÑ‰Ð¸Ð¹ ÑÐ¿Ð¸ÑÐ¾Ðº "API" -->
                <div class="nav-dropdown">
                    <a href="{{ url_for('api_docs_bp.api_index') }}" class="dropdown-toggle">API â–¾</a>
                    <div class="dropdown-menu">
                        <a href="/apidocs" target="_blank" class="swagger-link">ðŸ“š Swagger Docs</a>
                        <div class="dropdown-divider"></div>
                        <a href="{{ url_for('api_docs_bp.api_tasks') }}">Tasks API</a>
                        <a href="{{ url_for('api_docs_bp.api_reminders') }}">Reminders API</a>
                        <a href="{{ url_for('api_docs_bp.api_validator') }}">Validator API</a>
                        <a href="{{ url_for('api_docs_bp.api_news') }}">News API</a>
                    </div>
                </div>
            </nav>

            <!-- 3. Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ (Ð¡Ð¿Ñ€Ð°Ð²Ð°) -->
            <div class="header-actions">
                <!-- ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÐµÐ»ÑŒ Ð¯Ð·Ñ‹ÐºÐ° -->
                <div class="lang-toggle">
                    <a href="{{ url_for('set_lang', lang_code='ru') }}" class="lang-btn {{ 'active' if current_lang == 'ru' else '' }}">RU</a>
                    <a href="{{ url_for('set_lang', lang_code='en') }}" class="lang-btn {{ 'active' if current_lang == 'en' else '' }}">EN</a>
                </div>

                <!-- ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÐµÐ»ÑŒ Ð¢ÐµÐ¼Ñ‹ -->
                <button class="theme-toggle" id="theme-toggle" title="Theme">
                    <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
                    <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
                </button>

                <!-- ÐÐ²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ -->
                <div class="auth-buttons">
                    {% if user %}
                        <!-- Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¾ Ð½Ð° t.hello -->
                        <span style="font-weight: 500; margin-right: 10px;">{{ t.hello }}, {{ user.login }}</span>
                        <a href="{{ url_for('logout') }}" class="btn-outline-small">{{ t.logout }}</a>
                    {% else %}
                        <a href="{{ url_for('login') }}" class="btn" style="color: #ffffff !important;">{{ t.login }}</a>
                        <a href="{{ url_for('register') }}" class="btn-outline-small">{{ t.register }}</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </header>

    <main class="site-main">
        <div class="container">
            {% block content %}{% endblock %}
        </div>
    </main>

    <footer class="site-footer">
        <div class="container footer-inner">
            <span>Â© 2026 Sokolov Web Lab</span>
            <span>{{ t.footer_text }}</span>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>