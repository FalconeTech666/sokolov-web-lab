{% extends "base.html" %}

{% block title %}–ö—É—Ä—Å—ã –≤–∞–ª—é—Ç ‚Äî Sokolov Web Lab{% endblock %}

{% block content %}
<div class="content-container">
    <div class="rates-wrapper">
        
        <!-- –ë–ª–æ–∫ 1: –¢–∞–±–ª–∏—Ü–∞ –∫—É—Ä—Å–æ–≤ -->
        <div class="rates-card">
            <div class="card-header-row">
                <h1>–ö—É—Ä—Å—ã –ù–ë–†–ë</h1>
                <!-- –§–æ—Ä–º–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã -->
                <form action="{{ url_for('rates') }}" method="post" class="date-select-form">
                    <input type="date" name="date_picker" value="{{ selected_date }}" onchange="this.form.submit()">
                </form>
            </div>
            
            {% if rates %}
            <table class="rates-table">
                <thead>
                    <tr>
                        <th>–í–∞–ª—é—Ç–∞</th>
                        <th>–ö—É—Ä—Å</th>
                        <th>–ö–æ–¥</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <div class="curr-flag">üá∫üá∏</div>
                            <div>
                                <div class="curr-name">–î–æ–ª–ª–∞—Ä –°–®–ê</div>
                                <div class="curr-scale">–∑–∞ {{ rates['USD']['scale'] }} —à—Ç.</div>
                            </div>
                        </td>
                        <td class="rate-val">{{ rates['USD']['rate'] }}</td>
                        <td class="curr-code">USD</td>
                    </tr>
                    <tr>
                        <td>
                            <div class="curr-flag">üá™üá∫</div>
                            <div>
                                <div class="curr-name">–ï–≤—Ä–æ</div>
                                <div class="curr-scale">–∑–∞ {{ rates['EUR']['scale'] }} —à—Ç.</div>
                            </div>
                        </td>
                        <td class="rate-val">{{ rates['EUR']['rate'] }}</td>
                        <td class="curr-code">EUR</td>
                    </tr>
                    <tr>
                        <td>
                            <div class="curr-flag">üá∑üá∫</div>
                            <div>
                                <div class="curr-name">–†–æ—Å—Å–∏–π—Å–∫–∏–π —Ä—É–±–ª—å</div>
                                <div class="curr-scale">–∑–∞ {{ rates['RUB']['scale'] }} —à—Ç.</div>
                            </div>
                        </td>
                        <td class="rate-val">{{ rates['RUB']['rate'] }}</td>
                        <td class="curr-code">RUB</td>
                    </tr>
                </tbody>
            </table>
            <p class="rates-info">–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∫—É—Ä—Å –Ω–∞ {{ selected_date }}</p>
            {% else %}
                <p class="error-msg">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫—É—Ä—Å—ã –Ω–∞ —ç—Ç—É –¥–∞—Ç—É.</p>
            {% endif %}
        </div>

        <!-- –ë–ª–æ–∫ 2: –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä -->
        <div class="converter-card">
            <h2>–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –≤–∞–ª—é—Ç</h2>
            <form action="{{ url_for('rates') }}" method="post" class="converter-form">
                <!-- –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ, —á—Ç–æ–±—ã –ø–µ—Ä–µ–¥–∞—Ç—å –¥–∞—Ç—É —Ä–∞—Å—á–µ—Ç–∞, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ–µ –Ω–µ –º–µ–Ω—è–ª -->
                <input type="hidden" name="calc_date" value="{{ selected_date }}">
                
                <div class="conv-row">
                    <label>–°—É–º–º–∞</label>
                    <input type="number" step="0.01" name="amount" placeholder="100" required 
                           value="{{ conversion.amount if conversion else '' }}">
                </div>

                <div class="conv-row-group">
                    <div class="conv-col">
                        <label>–ò–∑</label>
                        <select name="currency_from">
                            <option value="BYN" {% if conversion and conversion['from'] == 'BYN' %}selected{% endif %}>BYN</option>
                            <option value="USD" {% if conversion and conversion['from'] == 'USD' %}selected{% endif %}>USD</option>
                            <option value="EUR" {% if conversion and conversion['from'] == 'EUR' %}selected{% endif %}>EUR</option>
                            <option value="RUB" {% if conversion and conversion['from'] == 'RUB' %}selected{% endif %}>RUB</option>
                        </select>
                    </div>
                    <div class="conv-arrow">‚ûù</div>
                    <div class="conv-col">
                        <label>–í</label>
                        <select name="currency_to">
                            <option value="USD" {% if conversion and conversion['to'] == 'USD' %}selected{% endif %}>USD</option>
                            <option value="BYN" {% if conversion and conversion['to'] == 'BYN' %}selected{% endif %}>BYN</option>
                            <option value="EUR" {% if conversion and conversion['to'] == 'EUR' %}selected{% endif %}>EUR</option>
                            <option value="RUB" {% if conversion and conversion['to'] == 'RUB' %}selected{% endif %}>RUB</option>
                        </select>
                    </div>
                </div>

                <button type="submit" class="btn btn-full">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
            </form>

            {% if conversion %}
            <div class="conversion-result">
                <span class="res-from">{{ conversion.amount }} {{ conversion['from'] }} =</span>
                <span class="res-to">{{ conversion.result }} {{ conversion['to'] }}</span>
            </div>
            {% endif %}
        </div>

    </div>
</div>
{% endblock %}